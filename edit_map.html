<!DOCTYPE html>
<html>
<head>
  <title>Map Editor</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="main-container">
  <!-- Left side: Map area -->
  <div class="map-area">
    <!-- Main Controls -->
    <div class="main-controls">
      <!-- Left: File Menu -->
      <div class="control-group">
        <div class="file-menu">
          <button class="file-menu-btn tool-icon" id="fileMenuBtn">
            ğŸ“ File â–¼
          </button>
          <div class="file-menu-content" id="fileMenuContent">
            <button class="file-menu-item" id="menuImportTiles">ğŸ“¥ Import Tiles...</button>
            <button class="file-menu-item" id="menuImportMap">ğŸ“‚ Import Map...</button>
            <div class="menu-divider"></div>
            <button class="file-menu-item" id="menuSaveMap">ğŸ’¾ Save Map as TXT</button>
            <button class="file-menu-item" id="menuExportImage">ğŸ–¼ï¸ Export as PNG</button>
            <div class="menu-divider"></div>
            <button class="file-menu-item" id="menuClearMap" style="color: #fc8181;">ğŸ—‘ï¸ Clear Map</button>
          </div>
        </div>
      </div>
      
      <!-- Center: Mode Buttons with Undo/Redo -->
      <div class="control-group">
        <button id="modePlace" class="active tool-icon">ğŸ–Œï¸ Place</button>
        <button id="modeSelect" class="tool-icon">ğŸ”² Select</button>
        <button id="clearSelectedAreaBtn" class="tool-icon">ğŸ—‘ï¸ Area</button>
        <button id="deselectAllBtn" class="tool-icon">âœ–ï¸ Deselect</button>
        <button id="gridToggleBtn" class="tool-icon grid-toggle active">ğŸ”² Grid</button>
        
        <!-- Add Undo/Redo buttons -->
        <button id="undoBtn" class="tool-icon undo-btn" title="Undo (Ctrl+Z)">â†¶ Undo</button>
        <button id="redoBtn" class="tool-icon redo-btn" title="Redo (Ctrl+Y)">â†· Redo</button>
      </div>
      
      <!-- Right: Zoom Controls -->
      <div class="control-group">
        <button id="fitMapBtn" class="tool-icon zoom-btn">ğŸ“</button>
        <button id="zoomOutBtn" class="tool-icon zoom-btn">â–</button>
        <div class="zoom-display" id="zoomLevel">Fit</div>
        <button id="zoomInBtn" class="tool-icon zoom-btn">â•</button>
        <button id="zoom1xBtn" class="tool-icon zoom-1x">1x</button>
      </div>
    </div>

    <!-- Hidden file inputs -->
    <input type="file" id="importTileForMap" accept="image/png" multiple class="file-input-hidden"/>
    <input type="file" id="importMapTXT" accept=".txt" class="file-input-hidden"/>

    <!-- Map Container -->
    <div class="map-container" id="mapContainer">
      <div class="coord-display" id="coordDisplay">X:0 Y:0</div>
      <div class="selection-info" id="selectionInfo"></div>
      <canvas id="mapEditor"></canvas>
    </div>

    <!-- Status Bar -->
    <div class="status-bar">
      <div class="status-item">
        <span id="mapInfo">Map: 50Ã—50</span>
      </div>
      <div class="status-item">
        <span id="viewInfo">View: Fit</span>
        <span id="historyStatus" class="history-info"></span>
      </div>
      <div class="status-item">
        <span id="selectedInfo">Selected: 0</span>
      </div>
      <div class="status-item">
        <span id="tileCountInfo">Tiles: 0/2000</span>
      </div>
    </div>
  </div>

  <!-- Right side: Tile palette -->
  <div class="tile-area">
    <div class="tile-header">
      <h2>ğŸ¨ Tile Palette</h2>
      <div class="tile-info">
        <span id="tileInfo">No tiles imported</span>
        <span id="tileStats">0 tiles</span>
      </div>
    </div>
    
    <div class="import-btn" id="importTilesBtn">
      ğŸ“¥ Click to Import Tiles
    </div>
    
    <div class="tile-grid-container" id="tileGridContainer">
      <div class="empty-tiles" id="emptyTiles">
        <div class="icon">ğŸ¨</div>
        <p>No tiles imported yet</p>
        <p>Import PNG files to get started</p>
        <div class="hint">Supports 000-1999 numbered tiles</div>
      </div>
      <div class="tile-grid" id="tileGrid"></div>
    </div>
    
    <div class="tile-limit-warning" id="tileLimitWarning">
      âš ï¸ Tile limit: 2000 (000-1999)
    </div>
  </div>
</div>

<!-- jQuery -->
<script src="jquery.js"></script>
<script type="module" src="edit_map.js"></script>
</body>
</html>